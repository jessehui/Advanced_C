#蓝牙CC2540
1

SPI，是英语Serial Peripheral Interface 的缩写，顾名思义就是串行外围设备接口。 SPI ，是一种高速的，全双工，同步的通信总线
上升沿发送、下降沿接收、高位先发送。主机从机都这样。
上升沿到来的时候，sdo上的电平将被发送到从设备的寄存器中。     下降沿到来的时候，sdi上的电平将被接收到主设备的寄存器中。全双工通讯，一次传2个字节

2

IIC（Inter－Integrated Circuit）总线是由PHILIPS公司开发的两线式串行总线，用于连接微控制器及其外围设备。是微电子通信控制领域广泛采用的一种总线标准。它是同步通信的一种特殊形式，具有接口线少，控制方式简单，器件封装形式小，通信速率较高等优点。I2C 总线支持任何IC 生产过程(CMOS、双极性）。通过串行数据（SDA）线和串行时钟 （SCL）线在连接到总线的器件间传递信息。每个器件都有一个唯一的地址识别（无论是微控制器——MCU、LCD 驱动器、存储器或键盘接口），而且都可以作为一个发送器或接收器（由器件的功能决定）。
开始信号：SCL为高电平时，SDA由高电平向低电平跳变，开始传送数据。
  结束信号：SCL为低电平时，SDA由低电平向高电平跳变，结束传送数据。
2条双向串行线，一条数据线SDA，一条时钟线SCL。SDA传输数据是大端传输，每次传输8bit，即一字节。
数据传输：SCL为高电平时，SDA线若保持稳定，那么SDA上是在传输数据bit；若SDA发生跳变，则用来表示一个会话的开始或结束
数据改变：SCL为低电平时，SDA线才能改变传输的bit
IIC的数据输入输出用的是一根线，SPI则分为data IN和 data OUT。由于这个原因，采用IIC时CPU的端口占用少，SPI多一根。但是由于IIC的数据线是双向的，所以隔离比较复杂，SPI则比较容易。 所以系统内部通信可用IIC,若要与外部通信则最好用SPI带隔离（可以提高抗干扰能力）。但是IIC和SPI都不适合长距离传输。

3

UART(Universal Asynchronous Receiver and Transmitter)通用异步收发器（异步串行通信口），是一种通用的数据通信协议，它包括了RS232、RS499、RS423、RS422和RS485等接口标准规范和总线标准规范，即UART是异步串行通信口的总称。
而RS232、RS499、RS423、RS422和RS485等，是对应各种异步串行通信口的接口标准和总线标准，它规定了通信口的电气特性、传输速率、连接特性和接口的机械特性等内容，这些东东都是物理层的概念。通信协议，是属于通信网络中的数据链路层的概念。
起始位：先发出一个逻辑”0”信号，表示传输字符的开始。
数据位：可以是5~8位逻辑”0”或”1”。如ASCII码（7位），扩展BCD码（8位）。小端传输
校验位：数据位加上这一位后，使得“1”的位数应为偶数(偶校验)或奇数(奇校验)
停止位：它是一个字符数据的结束标志。可以是1位、1.5位、2位的高电平。
空闲位：处于逻辑“1”状态，表示当前线路上没有资料传送。
SPI：高速同步串行口。3～4线接口，收发独立、可同步进行
UART：通用异步串行口。按照标准波特率完成双向通讯，速度慢
SPI和UART可以实现全双工，但I2C不行
发送数据过程：空闲状态，线路处于高电位；当收到发送数据指令后，拉低线路一个数据位的时间T，接着数据按低位到高位依次发送，数据发送完毕后，接着发送奇偶校验位和停止位（停止位为高电位），一帧资料发送结束。
通信过程中实际只有两个管脚参与通信

    2脚：电脑的输入RXD
    3脚：电脑的输出TXD
    5脚：接地
  通过2，3脚就实现全双工（可同时收发）的串行异步通信


</br>
</br>
</br>
4

（一）、TTL电平标准
输出 L： <0.8V ； H：>2.4V。
输入 L： <1.2V ； H：>2.0V
TTL器件输出低电平要小于0.8V，高电平要大于2.4V。输入，低于1.2V就认为是0，高于2.0就认为是1。于是TTL电平的输入低电平的噪声容限就只有(0.8-0)/2=0.4V，高电平的噪声容限为(5-2.4)/2=1.3V。

（二）、CMOS电平标准
输出 L： <0.1*Vcc ； H：>0.9*Vcc。
输入 L： <0.3*Vcc ； H：>0.7*Vcc.
由于CMOS电源采用12V，则输入低于3.6V为低电平，噪声容限为1.8V，高于3.5V为高电平，噪声容限高为1.8V。比TTL有更高的噪声容限。

（三）、RS232标准
逻辑1的电平为-3～-15V，逻辑0的电平为+3～+15V，注意电平的定义反相了一次。

不足之处：

（1） 接口的信号电平值较高，易损坏接口电路的芯片，又因为与TTL 电平不兼容故需使用电平转换电路方能与TTL电路连接。
（2） RS232 可做到双向传输，全双工通讯 最高传输速率 20kbps。
（3） 接口使用一根信号线和一根信号返回线而构成共地的传输形式， 这种共地传输容易产生共模干扰，所以抗噪声干扰性弱。
（4） 传输距离有限，最大传输距离15米。

（四）RS485
逻辑1的电平为+2～+6V，逻辑0的电平为-2～-6V，

双向传输，半双工通讯, 最高传输速率10Mbps

最大传输距离约为1200m

RS-485接口是采用平衡驱动器和差分接收器的组合，抗共模干能力增强，即抗噪声干扰性好。

</br>
5

蓝牙4.0 2.4GHz-2.485GHz 共40个信道 每个信道宽度2MHz。其中3个为广播信道，其他37个为数据信道。
协议栈是协议的具体实现形式 也就是函数库，固件库。BLE：Bluetooth Low Energy
不需要深入了解协议的复杂过程，只需要知道数据从哪里来 到哪里去。然后根据协议栈，调用函数 满足自己的需要。
物理层（physical lawyer) : 信道带宽提供2M，提供3个广播信道
链路层（link lawyer）：执行基带协议底层的数据包管理协议
主机控制接口层（host controller interface）
逻辑链路层和适配协议层（Logical Link Control and Adaptation Protocol): 是蓝牙系统中的核心协议，负责适配基带中的上层协议,为上层提供数据传输业务，提供端到端的逻辑数字通信
安全管理层(Security Manager)：提供配对和秘钥分发的方法
通用接入层(Generic Access Profile)： 定义通用接口
属性协议层(Attribute Protocol)：允许设备以属性的方式向外暴露它的一些数据  例如广播者
通用属性剖面(Generic Attribute Protocol)：具体的应用属性的框架

6

CC2530 用作通用IO口时，可以组成3组，P0,P1,P2. 均可以通过SFR寄存器对P0P1P2进行位寻址和字节寻址。P1_0和P1_1具备20mA输出驱动能力外，其他只有4mA驱动能力。
寄存器PxSEL 用来设置端口每个引脚为通用IO或者外部设备IO信号。缺省状态下，或复位之后，所有数字输入输出引脚都设置为通用输入引脚。
要改变一个端口引脚的方向，就使用寄存器PxDIR来设置每个端口引脚为输入或输出。因此只要设置PxDIR中的指定位为1，其对应的引脚口就被设置为输出了

7寄存器赋值

如果要给某几位赋1 那么为了保持其他位不变 就可以让别的位 或 上0
e.g. P1DIR |= 0x01;//0000 0001 设置P1_0为输出
如果要给某几位赋0 那么为了保持其他位不变 就让别的位 与 上1
e.g. P2DIR &= ~0xc0//0011 1111;00表示uart0优先级最高

8 USART

UTX0IF不是寄存器，而是IRCON2中断标志寄存器的一位
表示UART0 TX中断标志 1：中断未决 0：无中断未决

9

头文件：#include <string.h>
memset() 函数用来将指定内存的前n个字节设置为特定的值，其原型为：
    void * memset( void * ptr, int value, size_t num );
参数说明：
- ptr 为要操作的内存的指针。
- value 为要设置的值。你既可以向 value 传递 int 类型的值，也可以传递 char 类型的值，int 和 char 可以根据 ASCII 码相互转换。
- num 为 ptr 的前 num 个字节，size_t 就是unsigned int。

【函数说明】memset() 会将 ptr 所指的内存区域的前 num 个字节的值都设置为 value，然后返回指向 ptr 的指针。

memset() 可以将一段内存空间全部设置为特定的值，所以经常用来初始化字符数组。例如：






char str[20];
memset(str, '\0', sizeof(str)-1);
【返回值】返回指向 ptr 的指针。

注意：参数 value 虽声明为 int，但必须是 unsigned char，所以范围在0 到255 之间。

范例：




```C

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int main()
{
// 不可以声明为 char *str = "http://c.biancheng.net";
    char str[] = "http://c.biancheng.net";
    memset(str, '-', 7);
    puts(str);
    system("pause");
    return EXIT_SUCCESS;
}
```

执行结果：

-------c.biancheng.net

注意：字符数组是可以被修改的，字符串是只读的，不能被修改，而 memset() 又必须修改 str，所以不能将 char str[] = "http://c.biancheng.net"; 声明为 char *str = "http://c.biancheng.net";，否则运行时会报错。

10 ADC

ADC三个寄存器 ADCCON1， ADCCON2， ADCCON3
2控制转换序列如何执行 3控制单个转换的通道号码参考电压和抽取率
